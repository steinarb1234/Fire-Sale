{% extends "base.html" %}
{% block content %}
    <div class="row">
        <div class="col-lg-2"></div>

        <div class="col-lg-8 d-flex flex-nowrap">
            <div class="item_img-container d-flex flex-row">
                {% include 'item/item_image_carousel.html' %}
            </div>

            <div id="main-item-info-container">
                <h1>{{ item_details.item_stats.item.name }}</h1>
                <h3>Price: ${{ item_details.item_stats.item.price }}</h3>
                <h4>Highest Offer: ${{ highest_price }}</h4>
                <p><span class="material-symbols-outlined">visibility</span>: {{ item_details.item_stats.views }}</p>
                <p><span class="material-symbols-outlined">favorite</span>: {{ watchlist_items|length }}</p>
                <p><span class="material-symbols-outlined">info</span>: {{ item_details.item_stats.status }}</p>
                <!-- TODO: Connect these buttons to their respective actions -->

                {% if request.user.id == item_details.item_stats.item.seller_id %}
                    <a href="{% url 'delete_item' item_details.item_stats.item.id %}" class="block btn btn-primary">Delete item</a>
                    <a href="{% url 'edit_item' item_details.item_stats.item.id %}" class="block btn btn-primary">Edit item</a>
                {% else %}
                    {% url 'create_offer' item_details.item_stats.item.id as the_url %}
                    <a href="{{ the_url }}" class="block btn btn-primary">Send an offer</a>
                    {% if in_watchlist %}
                        <a href="{% url 'delete_from_watchlist' item_details.item_stats.item.id %}" class="btn btn-primary">Remove from Watchlist</a>
                    {% else %}
                        <form method="POST" action="{% url 'add_to_watchlist' item_details.item_stats.item.id %}">
                            {% csrf_token %}
                            <button type="submit" class="btn btn-primary">Add to watchlist</button>
                        </form>
                    {% endif %}
                {% endif %}

            </div>

        </div>
        <div class="col-lg-2 border-start border-secondary-subtle">
            <div id="seller-info">
                <h4>Seller Information</h4>
                <p>Name: {{ item_details.item_stats.item.seller_id.full_name }}</p>
                <p>Rating: {{ item_details.item_stats.item.seller_id.avg_rating }}</p>
                <p>Location: {{ item_details.item_stats.item.seller.location }}</p>
            </div>
        </div>

        <div class="condition-and-description">
            <p>Condition:<br>{{ item_details.condition }}</p>
            <p>Description:<br>{{ item_details.description }}</p>
        </div>

    </div>

    {% with category_and_items as category %}
        {% include 'category/category_row.html' %}
    {% endwith %}
{% endblock %}
